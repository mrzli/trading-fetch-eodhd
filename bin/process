#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "dotenv/load"
require "optparse"

$LOAD_PATH.unshift(File.expand_path("../lib", __dir__))
require "eodhd"
require "eodhd/commands/process_args"

begin
	args = Eodhd::ProcessArgs.parse(ARGV)
rescue Eodhd::ProcessArgs::Help => e
	puts e.usage
	exit 0
rescue Eodhd::ProcessArgs::Error => e
	warn e.message
	warn e.usage if e.usage
	exit 2
end

Eodhd::Process.run(
	mode: args.mode,
	exchange_filters: args.exchange_filters,
	symbol_filters: args.symbol_filters
)
