#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "dotenv/load"

$LOAD_PATH.unshift(File.expand_path("../lib", __dir__))
require "eodhd"

begin
	cfg = Eodhd::Config.eodhd!
rescue Eodhd::Config::Error => e
	abort e.message
end

csv = Eodhd::Fetch.fetch_mcd_csv!(
  api_token: cfg.api_token,
  base_url: cfg.base_url
)

output_path = Eodhd::Fetch.save_mcd_csv!(csv: csv, output_dir: cfg.output_dir)
puts "Wrote #{output_path}"
